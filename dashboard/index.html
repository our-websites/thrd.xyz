<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Thrd Dashboard</title>
<link rel="icon" type="image/x-icon" href="https://thrd.xyz/favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Inter Font -->
<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
* {margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif;}
body {background:#1a1a1a;color:#fff;overflow-x:hidden;}
a {text-decoration:none;color:inherit;}

.sidebar {width:64; background:#111; min-height:100vh; padding:2rem 1rem; display:flex; flex-direction:column; gap:2rem;}
.sidebar .logo {display:flex; align-items:center; gap:0.5rem; margin-bottom:2rem;}
.sidebar .logo img {height:40px; width:auto;}
.sidebar .logo span {color:#ffb347; font-weight:bold; font-size:1.5rem;}
.sidebar .user-info {text-align:center;}
.sidebar .user-info img {width:80px; height:80px; border-radius:9999px; margin:0 auto 0.5rem auto;}
.sidebar .user-info h2 {color:#ffb347; font-weight:bold;}
.sidebar .user-info p {color:#ccc; font-size:0.85rem;}
.sidebar-btn {display:flex; align-items:center; gap:0.5rem; padding:0.75rem 1rem; border-radius:0.75rem; transition:0.2s; cursor:pointer; color:#fff;}
.sidebar-btn:hover, .sidebar-btn.active {background:linear-gradient(90deg,#ff7518,#ffb347); color:#1a1a1a;}
.main {flex:1; padding:2rem; display:flex; flex-direction:column; gap:2rem;}
.main h1 {font-size:2.5rem; font-weight:bold; background:linear-gradient(90deg,#ffb347,#ff7518); -webkit-background-clip:text; -webkit-text-fill-color:transparent;}
.card {background:linear-gradient(145deg,#222,#1a1a1a); border-radius:1rem; padding:2rem; transition:transform 0.3s ease, box-shadow 0.3s ease; display:flex; flex-direction:column; gap:1rem;}
.card:hover {transform:translateY(-5px); box-shadow:0 10px 25px rgba(255,117,24,0.4);}
.card i {font-size:2rem; color:#ff7518;}
.loading-overlay {position:fixed; inset:0; background:rgba(0,0,0,0.8); display:flex; justify-content:center; align-items:center; z-index:50;}
.spinner {border:4px solid rgba(255,255,255,0.2); border-top:4px solid #ff7518; border-radius:50%; width:50px; height:50px; animation:spin 1s linear infinite;}
@keyframes spin {0% {transform:rotate(0deg);} 100% {transform:rotate(360deg);}}
</style>
</head>
<body class="flex">

<!-- Loading overlay -->
<div id="loadingOverlay" class="loading-overlay">
  <div class="spinner"></div>
</div>

<!-- Sidebar -->
<div class="sidebar">
  <div class="logo">
    <img src="https://thrd.xyz/logo.png" alt="Logo">
    <span>Thrd</span>
  </div>
  <div class="user-info">
    <img id="userAvatar" src="https://cdn.discordapp.com/embed/avatars/0.png" alt="Avatar">
    <h2 id="userName">Loading...</h2>
    <p id="userEmail"></p>
  </div>
  <div class="flex flex-col gap-2 mt-4">
    <div class="sidebar-btn active"><i class="fas fa-home"></i> Dashboard</div>
    <div class="sidebar-btn"><i class="fas fa-robot"></i> Bots</div>
    <div class="sidebar-btn"><i class="fas fa-key"></i> Credentials</div>
  </div>
</div>

<!-- Main content -->
<div class="main">
  <h1>Welcome to Thrd Dashboard</h1>
  <div class="card">
    <i class="fas fa-server"></i>
    <h3>Your Servers</h3>
    <p>Manage your Discord bots here. Click a bot to see details and resources allocated.</p>
  </div>
  <div class="card">
    <i class="fas fa-cogs"></i>
    <h3>Settings</h3>
    <p>Update your credentials, tokens, and other settings for seamless bot management.</p>
  </div>
</div>

<script type="module">
import { createClient } from "https://cdn.skypack.dev/@supabase/supabase-js";

const SUPABASE_URL = "https://jmxlhugggzvgpuuwvyly.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpteGxodWdnZ3p2Z3B1dXd2eWx5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA4MjA3NTQsImV4cCI6MjA3NjM5Njc1NH0.gDTnN7pSfGGUoXN2XTR8SpMDjJVW-K9KpiO8SAC3e4I";
const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

(async function() {
  const overlay = document.getElementById('loadingOverlay');
  const hash = new URLSearchParams(window.location.hash.slice(1));
  const accessToken = hash.get('access_token');
  const refreshToken = hash.get('refresh_token');

  if (accessToken) {
    const { error } = await supabase.auth.setSession({
      access_token: accessToken,
      refresh_token: refreshToken
    });
    if (error) return window.location.href = "/";
    window.history.replaceState(null, "", window.location.pathname);
    await new Promise(r => setTimeout(r,100));
  }

  const { data:{ session }, error: sessionError } = await supabase.auth.getSession();
  if (sessionError || !session) return window.location.href = "/";

  const { data:{ user }, error: userError } = await supabase.auth.getUser();
  if (userError || !user) return window.location.href = "/";

  document.getElementById('userAvatar').src = user.user_metadata?.avatar_url || "https://cdn.discordapp.com/embed/avatars/0.png";
  document.getElementById('userName').textContent = user.user_metadata?.full_name || user.email;
  document.getElementById('userEmail').textContent = user.email;

  overlay.style.display = 'none';
})();
</script>

</body>
</html>
