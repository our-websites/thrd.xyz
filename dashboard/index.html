<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thrd Hosting - Dashboard</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
* {margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
body {background:#1a1a1a;color:#fff;overflow-x:hidden;}
a {text-decoration:none;color:inherit;}
header {display:flex;justify-content:space-between;align-items:center;padding:20px 50px;background:linear-gradient(90deg, #ff7518, #ffb347);box-shadow:0 5px 15px rgba(0,0,0,0.3);position:sticky; top:0; z-index:100;}
.header-right {display:flex;align-items:center;gap:15px;}
.status-link {color:white;font-weight:bold;font-size:1rem;text-decoration:none;transition:color 0.3s ease;}
.status-link:hover { color:#ffb347; }
.dashboard-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;padding:40px;}
.bot-card {background:linear-gradient(145deg,#222,#1a1a1a);padding:30px;border-radius:20px;text-align:center;cursor:pointer;transition:transform 0.3s ease,box-shadow 0.3s ease;position:relative;}
.bot-card:hover {transform:translateY(-10px);box-shadow:0 15px 30px rgba(255,117,24,0.4);}
.bot-card h3 {font-size:1.5rem;margin-bottom:10px;background:linear-gradient(90deg,#ffb347,#ff7518);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.bot-card p {color:#ccc;font-size:1rem;}
.create-btn {grid-column:span 1;background:linear-gradient(90deg,#ff7518,#ffb347);color:#1a1a1a;padding:20px;border-radius:20px;font-weight:bold;font-size:1.2rem;display:flex;justify-content:center;align-items:center;cursor:pointer;transition:transform 0.3s ease,box-shadow 0.3s ease;}
.create-btn:hover {transform:translateY(-5px);box-shadow:0 10px 25px rgba(255,117,24,0.5);}
.modal {position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity 0.3s ease;}
.modal.active {opacity:1;pointer-events:auto;}
.modal-content {background:#111;padding:30px;border-radius:20px;max-width:500px;width:90%;position:relative;text-align:left;}
.modal-content h3 {background:linear-gradient(90deg,#ffb347,#ff7518);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:15px;}
.modal-content p {color:#ccc;margin-bottom:10px;}
.modal-close {position:absolute;top:15px;right:20px;font-size:1.5rem;cursor:pointer;color:#fff;}
</style>
</head>
<body>

<header>
    <h1>Thrd Hosting</h1>
    <div class="header-right">
        <a class="status-link" href="/status">Status</a>
        <div class="login-btn" id="loginBtn"><i class="fab fa-discord"></i>Login</div>
    </div>
</header>

<section class="dashboard-grid" id="botGrid">
    <div class="create-btn" id="createBotBtn"><i class="fas fa-plus"></i> Create New Bot</div>
</section>

<div class="modal" id="botModal">
    <div class="modal-content">
        <span class="modal-close" id="closeModal">&times;</span>
        <h3 id="modalBotName"></h3>
        <p><strong>Status:</strong> <span id="modalBotStatus"></span></p>
        <p><strong>CPU:</strong> <span id="modalBotCPU"></span></p>
        <p><strong>RAM:</strong> <span id="modalBotRAM"></span></p>
        <p><strong>External:</strong> <a href="#" id="modalBotExternal" target="_blank">Open</a></p>
    </div>
</div>

<script>
const supabase = window.supabase.createClient(
  "https://jmxlhugggzvgpuuwvyly.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpteGxodWdnZ3B2Z3B1dXd2eWx5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA4MjA3NTQsImV4cCI6MjA3NjM5Njc1NH0.gDTnN7pSfGGUoXN2XTR8SpMDjJVW-K9KpiO8SAC3e4I"
);

async function signInWithDiscord() {
  const { data, error } = await supabase.auth.signInWithOAuth({
    provider: 'discord',
    options: { redirectTo: window.location.origin + '/dashboard' }
  });
  if (error) alert("Failed to login: " + error.message);
}

document.getElementById("loginBtn").addEventListener("click", signInWithDiscord);

supabase.auth.getSession().then(({ data }) => {
  if (data.session) {
    document.getElementById("loginBtn").innerHTML = '<i class="fas fa-user"></i> Dashboard';
    document.getElementById("loginBtn").onclick = () => window.location.href = '/dashboard';
    loadBots(data.session.user.id);
  }
});

// Sample bot data fetch
async function loadBots(userId) {
    // Replace with your Supabase table 'bots' and user_id filter
    let { data: bots, error } = await supabase.from('bots').select('*').eq('user_id', userId);
    if (error) { console.error(error); return; }

    const grid = document.getElementById("botGrid");
    bots.forEach(bot => {
        const card = document.createElement("div");
        card.className = "bot-card";
        card.innerHTML = `<h3>${bot.name}</h3><p>Status: ${bot.status}</p>`;
        card.onclick = () => openModal(bot);
        grid.appendChild(card);
    });
}

document.getElementById("createBotBtn").addEventListener("click", () => {
    alert("Redirect to bot creation page or open a form.");
});

// Modal
const modal = document.getElementById("botModal");
const closeModalBtn = document.getElementById("closeModal");
function openModal(bot) {
    document.getElementById("modalBotName").textContent = bot.name;
    document.getElementById("modalBotStatus").textContent = bot.status;
    document.getElementById("modalBotCPU").textContent = bot.cpu || 'N/A';
    document.getElementById("modalBotRAM").textContent = bot.ram || 'N/A';
    document.getElementById("modalBotExternal").href = bot.external_url || '#';
    modal.classList.add("active");
}
closeModalBtn.onclick = () => modal.classList.remove("active");
window.onclick = e => { if(e.target == modal) modal.classList.remove("active"); }
</script>

</body>
</html>
